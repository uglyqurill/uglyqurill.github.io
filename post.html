<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Пост — Кирилл Брызгунов</title>
  <link rel="stylesheet" href="../styles.css" />
  <script src="./md.js"></script>
</head>
<body>
  <div class="container">
    <nav class="nav">
      <a href="../index.html">Главная</a>
      <a href="./index.html">Блог</a>
    </nav>

    <article class="card">
      <div id="post"></div>
    </article>

    <footer class="footer">
      © <span id="year"></span> Кирилл Брызгунов
    </footer>
  </div>

  <script>
    function qs(key){ const p = new URLSearchParams(location.search); return p.get(key); }
    async function loadPost(){
      document.getElementById('year').textContent = new Date().getFullYear();
      const slug = qs('slug');
      if(!slug){ document.getElementById('post').innerHTML = '<p class="muted">Пост не найден.</p>'; return; }
      try{
        const md = await (await fetch('./posts/' + slug + '.md')).text();
        const html = mdToHtml(md);
        document.getElementById('post').innerHTML = html;
        const h1 = document.querySelector('h1');
        if(h1) document.title = h1.textContent + ' — Блог';
      }catch(e){
        document.getElementById('post').innerHTML = '<p class="muted">Не удалось загрузить пост.</p>';
      }
    }
    loadPost();
  </script>
</body>
</html>
